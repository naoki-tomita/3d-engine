(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();class A{constructor(e){this.faces=e}get vertices(){return this.faces.map(e=>[e.v1,e.v2,e.v3]).flat()}}class x{constructor(e,r,c){this.x=e,this.y=r,this.z=c}get norm(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}normalize(e=1){const r=this.norm;return new x(this.x&&this.x/r*e,this.y&&this.y/r*e,this.z&&this.z/r*e)}cross(e){return new x(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}toVertex3D(){return new i(this.x,this.y,this.z)}angle(e){return this.dot(e)/(this.norm*e.norm)}}class i{constructor(e,r,c){this.x=e,this.y=r,this.z=c}subtract(e){return new i(this.x-e.x,this.y-e.y,this.z-e.z)}add(e){return new i(this.x+e.x,this.y+e.y,this.z+e.z)}toNormalizedVector(){return this.toVector().normalize()}toVector(){return new x(this.x,this.y,this.z)}}class g{constructor(e,r){this.x=e,this.y=r}}const y=class{constructor(a,e,r,c=1){this.a=c,this.r=Math.floor(a),this.g=Math.floor(e),this.b=Math.floor(r)}darken(a=1){return new y(Math.floor(this.r*a),Math.floor(this.g*a),Math.floor(this.b*a),this.a)}get value(){return`rgba(${this.r},${this.g},${this.b},${this.a})`}};let l=y;l.Red=new y(255,0,0);l.Green=new y(0,255,0);l.Blue=new y(0,0,255);l.Yellow=new y(255,255,0);l.Pink=new y(255,20,147);l.Orange=new y(255,99,71);l.Cyan=new y(0,255,255);l.Purple=new y(255,0,255);class w{constructor(e,r,c,o){this.v1=e,this.v2=r,this.v3=c,this.color=o}get normalVector(){const e=this.v2.subtract(this.v1).toVector(),r=this.v3.subtract(this.v2).toVector();return e.cross(r).normalize()}get center(){return new i((this.v1.x+this.v2.x+this.v3.x)/3,(this.v1.y+this.v2.y+this.v3.y)/3,(this.v1.z+this.v2.z+this.v3.z)/3)}}function b(a,e){const r=e.x,c=e.y,o=e.z,n=1,s=[];for(let t=0;t<4;t++){const z=a[0][t],f=a[1][t],p=a[2][t],k=a[3][t],v=r*z+c*f+o*p+n*k;s.push(v)}return new i(s[0]/s[3],s[1]/s[3],s[2]/s[3])}function u(a,e,r){const c=e.subtract(a).toNormalizedVector(),o=new x(0,1,0),n=c.cross(o).normalize(),s=n.cross(c),t=[[n.x,s.x,c.x,0],[n.y,s.y,c.y,0],[n.z,s.z,c.z,0],[0,0,0,1]];return b(t,a.subtract(r))}class M{constructor(e,r,c){this.view=e,this.camera=r,this.objects=c}render(){const e=this.objects.map(r=>r.faces.map(c=>new w(u(this.camera.position,this.camera.lookAt,c.v1),u(this.camera.position,this.camera.lookAt,c.v2),u(this.camera.position,this.camera.lookAt,c.v3),c.color))).flat();this.view.clear(),e.sort((r,c)=>r.center.z-c.center.z).filter(r=>r.v1.z<0&&r.v2.z<0&&r.v3.z<0).filter(r=>r.center.toVector().angle(r.normalVector)<=0).forEach(r=>{this.view.draw(this.camera.project(r.v1),this.camera.project(r.v2),this.camera.project(r.v3),r.color)})}}class P{constructor(){const e=document.querySelector("canvas");this.context=e.getContext("2d"),this.width=e.width,this.height=e.height}clear(){this.context.clearRect(0,0,this.width,this.height)}draw(e,r,c,o){const n=this.width/2,s=this.height/2;this.context.beginPath(),this.context.moveTo(e.x+n,-e.y+s),this.context.lineTo(r.x+n,-r.y+s),this.context.lineTo(c.x+n,-c.y+s),this.context.closePath(),this.context.strokeStyle="black",this.context.stroke(),this.context.fillStyle=o.value,this.context.fill()}}class V{constructor(e,r){this.position=e,this.lookAt=r}project(e){const r=500/(e.z||1e-6);return new g(r*e.x,r*e.y)}}function d(a,e,r,c){const o=c/2,n=c/2,s=c/2,t={x:a,y:e,z:r},z=[new w(new i(t.x-o,t.y-n,t.z-s),new i(t.x+o,t.y-n,t.z-s),new i(t.x-o,t.y-n,t.z+s),l.Red),new w(new i(t.x+o,t.y-n,t.z-s),new i(t.x+o,t.y-n,t.z+s),new i(t.x-o,t.y-n,t.z+s),l.Red),new w(new i(t.x-o,t.y-n,t.z+s),new i(t.x+o,t.y-n,t.z+s),new i(t.x-o,t.y+n,t.z+s),l.Blue),new w(new i(t.x-o,t.y+n,t.z+s),new i(t.x+o,t.y-n,t.z+s),new i(t.x+o,t.y+n,t.z+s),l.Blue),new w(new i(t.x+o,t.y-n,t.z-s),new i(t.x+o,t.y+n,t.z-s),new i(t.x+o,t.y-n,t.z+s),l.Green),new w(new i(t.x+o,t.y+n,t.z-s),new i(t.x+o,t.y+n,t.z+s),new i(t.x+o,t.y-n,t.z+s),l.Green),new w(new i(t.x-o,t.y+n,t.z-s),new i(t.x-o,t.y+n,t.z+s),new i(t.x+o,t.y+n,t.z-s),l.Orange),new w(new i(t.x+o,t.y+n,t.z-s),new i(t.x-o,t.y+n,t.z+s),new i(t.x+o,t.y+n,t.z+s),l.Orange),new w(new i(t.x-o,t.y-n,t.z-s),new i(t.x-o,t.y-n,t.z+s),new i(t.x-o,t.y+n,t.z+s),l.Pink),new w(new i(t.x-o,t.y-n,t.z-s),new i(t.x-o,t.y+n,t.z+s),new i(t.x-o,t.y+n,t.z-s),l.Pink),new w(new i(t.x-o,t.y-n,t.z-s),new i(t.x-o,t.y+n,t.z-s),new i(t.x+o,t.y-n,t.z-s),l.Yellow),new w(new i(t.x+o,t.y-n,t.z-s),new i(t.x-o,t.y+n,t.z-s),new i(t.x+o,t.y+n,t.z-s),l.Yellow)];return new A(z)}const h=new V(new i(1.3,1.3,1.3),new i(1,1,2)),O=d(1,1,2,.1),j=d(1,1,4,.5),C=new P,L=new M(C,h,[O,j]);function m(){L.render(),requestAnimationFrame(m)}requestAnimationFrame(m);window.addEventListener("keydown",a=>{a.key==="ArrowUp"&&(h.lookAt.z=h.lookAt.z+.1,h.position.z=h.position.z+.1),a.key==="ArrowDown"&&(h.lookAt.z=h.lookAt.z-.1,h.position.z=h.position.z-.1),a.key==="ArrowLeft"&&(h.lookAt.x=h.lookAt.x+.1,h.position.x=h.position.x+.1),a.key==="ArrowRight"&&(h.lookAt.x=h.lookAt.x-.1,h.position.x=h.position.x-.1),a.key===" "&&(h.lookAt.y=h.lookAt.y+.1,h.position.y=h.position.y+.1),a.key==="Control"&&(h.lookAt.y=h.lookAt.y-.1,h.position.y=h.position.y-.1),a.key==="w"&&(h.lookAt.z=h.lookAt.z+.1),a.key==="s"&&(h.lookAt.z=h.lookAt.z-.1),a.key==="a"&&(h.lookAt.x=h.lookAt.x+.1),a.key==="d"&&(h.lookAt.x=h.lookAt.x-.1)});
